{% extends "base.html" %}
{% block title %}Spectacle'ment V√òtre - Spectacles et animations pour enfants, entreprises, anniversaires | Artistes professionnels{% endblock %}
{% block description %}D√©couvrez des spectacles pour enfants, animations d'entreprise et d'anniversaire. Magie, th√©√¢tre, cirque, clowns, marionnettes. R√©servez directement avec des artistes professionnels en France.{% endblock %}
{% block content %}



<div style="display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:16px;">
  <h1 style="font-size:1.15rem;margin:0;font-weight:500;color:#fff;line-height:1.4;">Mairie, CSE, Ecole, pour trouver rapidement la bonne animation, au bon public, au bon endroit.</h1>
  <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
    <a href="{{ url_for('demande_animation') }}" style="background:linear-gradient(135deg,#162447 0%,#283e5e 100%);color:#fff;padding:8px 18px;border-radius:22px;font-weight:600;font-size:0.95rem;text-decoration:none;box-shadow:0 2px 8px #16244744;transition:background .2s;white-space:nowrap;display:inline-block;letter-spacing:0.5px;">
        Je cherche un spectacle
      </a>
      <a href="{{ url_for('publish') }}" style="background:linear-gradient(135deg,#1b2a4e 0%,#355c7d 100%);color:#fff;padding:8px 18px;border-radius:22px;font-weight:600;font-size:0.95rem;text-decoration:none;box-shadow:0 2px 8px #1b2a4e44;transition:background .2s;white-space:nowrap;display:inline-block;letter-spacing:0.5px;">
        Je suis artiste / compagnie
      </a>
      <a href="{{ url_for('abonnement_compagnie') }}" style="background:linear-gradient(135deg,#283e5e 0%,#1976d2 100%);color:#fff;padding:8px 18px;border-radius:22px;font-weight:600;font-size:0.95rem;text-decoration:none;box-shadow:0 2px 8px #1976d244;transition:background .2s;white-space:nowrap;display:inline-block;letter-spacing:0.5px;">
        Abonnement Compagnie
      </a>
  </div>
</div>


<form action="" method="get"
      style="display:flex; align-items:center; gap:12px; background:linear-gradient(135deg,#162447 0%,#283e5e 100%); border:2px solid #283e5e; padding:10px 16px; border-radius:14px; margin:0 0 20px; box-shadow:0 2px 8px #16244722; color:#fff;"
      role="search"
      aria-label="Rechercher un spectacle">
  <span aria-hidden="true" style="color:var(--muted);">üîç</span>
  <input name="q" value="{{ q or '' }}"
    placeholder="Recherche cat√©gorie, spectacle, √¢ge..."
    aria-label="Recherche g√©n√©rale"
    style="flex:2; border:none; background:transparent; outline:none; font-size:15px; color:var(--text);">
  <span style="color:var(--border);">|</span>
  <input name="location" value="{{ location or '' }}"
    placeholder="Ville ou r√©gion..."
            
    style="flex:1; border:none; background:transparent; outline:none; font-size:15px; color:var(--text);">
  <button type="submit"
     style="border:none; background:var(--primary); color:white; font-weight:600; cursor:pointer; padding:6px 14px; border-radius:8px;">Rechercher</button>
</form>

<div class="page-layout">
  <!-- COLONNE GAUCHE : catalogue -->
  <div class="page-main">
    <h2 id="catalogue-title" style="margin-top:0; margin-bottom:16px; font-size:1.15rem; font-weight:500; color:#fff; line-height:1.4;">Spectacle'ment V√òtre la plateforme qui connecte facilement les organisateurs d‚Äô√©v√©nements avec des artistes et compagnies de spectacle vivant.</h2>
    <div style="display:flex; align-items:center; gap:8px; margin-bottom:18px;">
      <span style="font-size:1.3em; color:#f1c40f;">‚ú®</span>
      <span style="color:#f1c40f; font-size:1em; font-weight:600; letter-spacing:0.5px;"> Nouveaut√©s du mois : spectacles & animations au rendez-vous. </span>
    </div>
    <div class="cards">
      {% for show in shows or [] %}
      <article class="card" style="border:2px solid #222;border-radius:16px;box-shadow:0 2px 12px #0008;padding:0 0 8px 0;transition:box-shadow .2s;color:#fff;">
        <a href="{{ url_for('show_detail', show_id=show.id) }}" class="media-link">
          <div class="media">
            {% if show.has_image() %}
              <img src="{{ url_for('uploaded_file', filename=show.file_name) }}" alt="{{ show.title }}">
            {% elif show.is_pdf() %}
              <div class="pdf-thumb">
                <a href="{{ url_for('uploaded_file', filename=show.file_name) }}" target="_blank" rel="noopener">PDF</a>
              </div>
            {% else %}
              <div class="placeholder">Aucun fichier</div>
            {% endif %}
          </div>
        </a>

        <a href="{{ url_for('show_detail', show_id=show.id) }}" class="content-link">
          <div class="content">
            {% if show.raison_sociale %}
              <p class="meta" style="font-weight:600; margin-bottom:8px; color:var(--primary); font-size:0.85em;">
                {{ show.raison_sociale }}
              </p>
            {% endif %}
            <h3 style="margin:0 0 6px 0; line-height:1.2;">{{ show.title }}</h3>
            
            <div style="display:flex; flex-direction:column; gap:4px; font-size:0.85em; margin-top:-2px;">

              

              
              {% if show.age_range %}
              <div style="display:flex; align-items:center; gap:6px;">
                <span style="opacity:0.7; min-width:20px;">üë•</span>
                <span style="color:rgba(255,255,255,0.9);">{{ show.age_range }}</span>
              </div>
              {% endif %}

            </div>
            
            {% if not show.approved %}

            {% endif %}
          </div>
        </a>

        {% if user and user.is_admin %}
        <div class="actions">
          <a href="{{ url_for('show_edit', show_id=show.id) }}">Modifier</a>

          <form action="{{ url_for('show_delete', show_id=show.id) }}" method="post"
                onsubmit="return confirm('Supprimer cette annonce ?');">
            <button type="submit" class="danger">Supprimer</button>
          </form>

          {% if not show.approved %}
          <form action="{{ url_for('show_approve', show_id=show.id) }}" method="post">
            <button type="submit">‚úÖ Valider</button>
          </form>
          {% endif %}
        </div>
        {% endif %}
      </article>
      {% endfor %}
    </div>


    {# PAGINATION #}
    {% if pagination and pagination.pages > 1 %}
    <nav class="pagination" style="margin: 30px 0; text-align: center;">
      <div style="display: inline-flex; gap: 8px; align-items: center; flex-wrap: wrap; justify-content: center;">
        {% if pagination.has_prev %}
           <a href="{{ url_for('home', page=pagination.prev_num, q=q, category=category, location=location, type=type_filter, sort=sort, date_from=date_from, date_to=date_to) }}"
             style="padding: 8px 12px; background: var(--primary); color: white; text-decoration: none; border-radius: 4px; font-weight: 600;">
            ‚Üê Pr√©c√©dent
          </a>
        {% else %}
          <span style="padding: 8px 12px; background: #ddd; color: #999; border-radius: 4px; font-weight: 600;">
            ‚Üê Pr√©c√©dent
          </span>
        {% endif %}

        {% for p in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
          {% if p %}
            {% if p == pagination.page %}
              <span style="padding: 8px 12px; background: var(--primary); color: white; border-radius: 4px; font-weight: 600;">
                {{ p }}
              </span>
            {% else %}
                <a href="{{ url_for('home', page=p, q=q, category=category, location=location, type=type_filter, sort=sort, date_from=date_from, date_to=date_to) }}"
                  style="padding: 8px 12px; background: #f2f3f7; color: var(--text); text-decoration: none; border-radius: 4px; font-weight: 600;"{% if p == 1 %} rel="first"{% endif %}>
                {{ p }}
              </a>
            {% endif %}
          {% else %}
            <span style="padding: 8px 12px; color: #999;">...</span>
          {% endif %}
        {% endfor %}

        {% if pagination.has_next %}
           <a href="{{ url_for('home', page=pagination.next_num, q=q, category=category, location=location, type=type_filter, sort=sort, date_from=date_from, date_to=date_to) }}"
             rel="next"
             style="padding: 8px 12px; background: var(--primary); color: white; text-decoration: none; border-radius: 4px; font-weight: 600;">
            Suivant ‚Üí
          </a>
        {% else %}
          <span style="padding: 8px 12px; background: #ddd; color: #999; border-radius: 4px; font-weight: 600;">
            Suivant ‚Üí
          </span>
        {% endif %}
      </div>

      <p style="margin-top: 16px; color: var(--muted); font-size: 0.9rem;">
        Page {{ pagination.page }} sur {{ pagination.pages }} ({{ pagination.total }} r√©sultat{{ 's' if pagination.total > 1 else '' }})
      </p>
    </nav>
    {% endif %}

  </div>

  <!-- COLONNE DROITE : ton nouveau bloc -->
  <aside class="page-sidebar">
    <section class="seo-block" style="background:linear-gradient(135deg,#162447 0%,#283e5e 100%); border:2px solid #283e5e; border-radius:16px; padding:24px; margin-bottom:24px; box-shadow:0 2px 12px #16244722; color:#fff;">
      <h2>Mairie, CSE, Ecole etc. ‚Äî Besoin d‚Äôun spectacle, une animation, un atelier, un concert, un DJ etc..?</h2>
      <p>
        Retrouvez rapidement un spectacle par th√®me&nbsp;:
      </p>
        <div style="margin: 12px 0 18px 0; text-align:center;">
          <a href="#" class="btn btn-featured theme-btn" data-theme="une" style="display:inline-block; background:#162447; color:#fff; font-weight:700; border-radius:8px; padding:12px 28px; font-size:1.08em; box-shadow:0 2px 8px #16244744; text-decoration:none; transition:background 0.2s;">Spectacle √† la une</a>
        </div>
      <ul style="list-style:none; padding:0; margin:0 0 12px 0;">
        <li><a href="#" class="theme-btn" data-theme="marionnette" style="color:#fff;">Marionnette</a></li>
        <li><a href="#" class="theme-btn" data-theme="magie" style="color:#fff;">Magie</a></li>
        <li><a href="#" class="theme-btn" data-theme="clown" style="color:#fff;">Clown</a></li>
        <li><a href="#" class="theme-btn" data-theme="th√©√¢tre" style="color:#fff;">Th√©√¢tre</a></li>
        <li><a href="#" class="theme-btn" data-theme="danse" style="color:#fff;">Danse</a></li>
        <li><a href="#" class="theme-btn" data-theme="enfant" style="color:#fff;">Spectacle enfant</a></li>
        <li><a href="#" class="theme-btn" data-theme="atelier" style="color:#fff;">Atelier</a></li>
        <li><a href="#" class="theme-btn" data-theme="concert" style="color:#fff;">Concert</a></li>
        <li><a href="#" class="theme-btn" data-theme="cirque" style="color:#fff;">Cirque</a></li>
        <li><a href="#" class="theme-btn" data-theme="rue" style="color:#fff;">Spectacle de rue</a></li>
        <li><a href="#" class="theme-btn" data-theme="orchestre" style="color:#fff;">Orchestre</a></li>
        <li><a href="#" class="theme-btn" data-theme="Arbre de No√´l" style="color:#fff;font-weight:600;">Arbre de No√´l</a></li>
        <li><a href="#" class="theme-btn" data-theme="Animation √©cole" style="color:#fff;font-weight:600;">Animation √©cole</a></li>
        <li><a href="#" class="theme-btn" data-theme="F√™te de village" style="color:#fff;font-weight:600;">F√™te de village</a></li>
      </ul>
    </section>
  </aside>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {

  const themeBtns = document.querySelectorAll('.theme-btn');
  function resetAll() {
    window.location.href = window.location.pathname;
    localStorage.removeItem('selectedTheme');
  }
  themeBtns.forEach(btn => {
    btn.setAttribute('data-original', btn.textContent);
    btn.addEventListener('click', function(e) {
      // N'emp√™che le comportement par d√©faut QUE pour les boutons de th√®me
      e.preventDefault();
      let theme = btn.getAttribute('data-theme');
      // Pour les 3 boutons sp√©ciaux, garder accents pour la recherche
      if (["Arbre de No√´l", "Animation √©cole", "F√™te de village"].includes(theme)) {
        // rien, garder theme tel quel
      } else {
        theme = theme.toLowerCase();
      }
      const url = new URL(window.location.href);
      url.searchParams.set('category', theme);
      url.searchParams.delete('page');
      window.location.href = url.pathname + url.search;
      localStorage.setItem('selectedTheme', theme);
    });
  });
  // Bouton pour r√©initialiser le filtre
  const resetBtn = document.createElement('li');
  resetBtn.innerHTML = '<a href="#" style="color:#fff;font-weight:bold;">Tout</a>';
  resetBtn.addEventListener('click', function(e) {
    e.preventDefault();
    resetAll();
  });
  document.querySelector('.seo-block ul').insertBefore(resetBtn, document.querySelector('.seo-block ul').firstChild);
});
</script>

{% endblock %}
