{% extends "base.html" %}
{# Bloc robots : noindex uniquement si recherche textuelle (pas pour pagination ou filtres) #}
{% block robots %}
  {% if q %}
    <meta name="robots" content="noindex,follow">
  {% else %}
    <meta name="robots" content="index,follow">
  {% endif %}
{% endblock %}

{# Balises rel prev/next pour la pagination #}
{% if pagination %}
  {% if pagination.has_prev %}
    <link rel="prev" href="{{ url_for('home', page=pagination.prev_num, category=request.args.get('category', ''), location=request.args.get('location', ''), _external=True) }}">
  {% endif %}
  {% if pagination.has_next %}
    <link rel="next" href="{{ url_for('home', page=pagination.next_num, category=request.args.get('category', ''), location=request.args.get('location', ''), _external=True) }}">
  {% endif %}
{% endif %}



{# OG URL sans params aussi #}
{% block og_url %}{{ request.base_url }}{% endblock %}
{% block title %}Spectacle'ment V√òtre - Spectacles et animations pour enfants, entreprises, anniversaires | Artistes professionnels{% endblock %}
{% block description %}D√©couvrez des spectacles pour enfants, animations d'entreprise et d'anniversaire. Magie, th√©√¢tre, cirque, clowns, marionnettes. R√©servez directement avec des artistes professionnels en France.{% endblock %}
{% block content %}

<style>
@keyframes pulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 4px 15px rgba(109,19,19,0.5);
  }
  50% {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(109,19,19,0.8);
  }
}

@keyframes border-spin {
  0% {
    background-position: 0% 50%;
  }
  100% {
    background-position: 200% 50%;
  }
}

.btn-mairie-wrapper {
  position: relative;
  display: inline-block;
  padding: 3px;
  border-radius: 28px;
  background: linear-gradient(90deg, #ffc107, #ff5722, #e91e63, #9c27b0, #3f51b5, #2196f3, #00bcd4, #4caf50, #ffc107);
  background-size: 200% 100%;
  animation: border-spin 2s linear infinite;
}

.btn-mairie {
  display: block;
  background: #ffc107;
  color: #000;
  padding: 12px 24px;
  border-radius: 25px;
  font-weight: 700;
  font-size: 1.1rem;
  text-decoration: none;
  white-space: nowrap;
  letter-spacing: 0.8px;
  transition: all 0.3s;
}

.btn-mairie:hover {
  transform: scale(1.02);
}

.btn-artiste-wrapper {
  position: relative;
  display: inline-block;
  padding: 3px;
  border-radius: 28px;
  background: linear-gradient(90deg, #ffc107, #ffeb3b, #ff9800, #ffd54f, #ffca28, #fff176, #ffc107);
  background-size: 200% 100%;
  animation: border-spin 2s linear infinite;
}

.btn-artiste {
  display: block;
  background: linear-gradient(135deg, #ffc107 0%, #ffeb3b 50%, #ffd54f 100%);
  color: #000;
  padding: 8px 18px;
  border-radius: 25px;
  font-weight: 600;
  font-size: 0.95rem;
  text-decoration: none;
  white-space: nowrap;
  letter-spacing: 0.5px;
  transition: all 0.3s;
}

.btn-artiste:hover {
  transform: scale(1.02);
}

.btn-evenement-wrapper {
  position: relative;
  display: inline-block;
  padding: 3px;
  border-radius: 12px;
  background: linear-gradient(135deg, #0a0a1a 0%, #6d1313 25%, #e91e63 50%, #9c27b0 75%, #0a0a1a 100%);
  background-size: 300% 300%;
  animation: header-gradient-btn 8s ease infinite;
}

@keyframes header-gradient-btn {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.btn-evenement {
  display: block;
  background: linear-gradient(135deg, #1a0a0a 0%, #6d1313 30%, #8b1e1e 50%, #6d1313 70%, #1a0a0a 100%);
  background-size: 300% 300%;
  animation: header-gradient-btn 8s ease infinite;
  color: #fff;
  padding: 12px 28px;
  border-radius: 10px;
  font-weight: 700;
  font-size: 1.08em;
  text-decoration: none;
  white-space: nowrap;
  box-shadow: 0 4px 15px rgba(109, 19, 19, 0.5);
  transition: all 0.3s;
}

.btn-evenement:hover {
  transform: scale(1.03);
  box-shadow: 0 6px 20px rgba(233, 30, 99, 0.6);
}
</style>

<!-- Section Hero : Deux choix principaux -->
<style>
  .hero-choice-section {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    gap: 1.875rem;
    margin-bottom: 2.8125rem;
  }
  
  .hero-choice-section > a {
    -webkit-box-flex: 1;
    -ms-flex: 1 1 calc(50% - 1rem);
    flex: 1 1 calc(50% - 1rem);
    min-width: 280px;
  }
  
  @media (max-width: 768px) {
    .hero-choice-section {
      gap: 1.25rem;
    }
    .hero-choice-section > a {
      -ms-flex: 1 1 100%;
      flex: 1 1 100%;
    }
  }
  
  .hero-choice-card {
    display: block;
    background: linear-gradient(135deg, #162447 0%, #1f4068 50%, #283e5e 100%);
    border: 0.1875rem solid #355c7d;
    border-radius: 1.25rem;
    padding: 3.75rem 2.1875rem;
    text-align: center;
    text-decoration: none;
    color: #fff;
    -webkit-transition: all 0.3s ease;
    transition: all 0.3s ease;
    box-shadow: 0 0.5rem 1.875rem rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
  }
  
  .hero-choice-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 0.25rem;
    background: linear-gradient(90deg, #ffc107, #ff9800, #ffc107);
  }
  
  .hero-choice-card:hover {
    -webkit-transform: translateY(-0.5rem);
    transform: translateY(-0.5rem);
    border-color: #ffc107;
    box-shadow: 0 0.9375rem 2.8125rem rgba(255,193,7,0.25);
  }
  
  .hero-choice-card h2 {
    margin: 0 0 1.125rem 0;
    font-size: 1.5rem;
    color: #ffc107 !important;
    font-weight: 700;
    text-shadow: 0 0.125rem 0.5rem rgba(0,0,0,0.3);
    display: block;
    visibility: visible;
    opacity: 1;
  }
  
  .hero-choice-card p {
    margin: 0;
    font-size: 1rem;
    color: #fff;
    line-height: 1.6;
    text-align: center;
  }
  
  .hero-choice-card .cta-hint {
    display: inline-block;
    margin-top: 1.5625rem;
    padding: 0.75rem 1.75rem;
    background: #ffc107;
    border: none;
    border-radius: 1.5625rem;
    font-size: 1rem;
    color: #000;
    font-weight: 700;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  
  .hero-choice-card:hover .cta-hint {
    background: #ffeb3b;
    -webkit-transform: scale(1.05);
    transform: scale(1.05);
  }
  
  .hero-choice-card .desc-box {
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 0.625rem;
    padding: 0.75rem 1.25rem;
    margin: 0.9375rem auto 0 auto;
    display: inline-block;
  }
  
  /* Bloc hero artiste/compagnie - pleine largeur */
  .hero-artiste-card {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    width: 100%;
    background: linear-gradient(135deg, #ffc107 0%, #ff9800 50%, #ffd54f 100%);
    border: 0.1875rem solid #ff9800;
    border-radius: 1rem;
    padding: 1.25rem 2rem;
    text-align: center;
    text-decoration: none;
    color: #000;
    -webkit-transition: all 0.3s ease;
    transition: all 0.3s ease;
    box-shadow: 0 0.375rem 1.25rem rgba(255,152,0,0.4);
    position: relative;
    overflow: hidden;
    margin-top: 1rem;
  }
  
  .hero-artiste-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 0.1875rem;
    background: linear-gradient(90deg, #fff, #ffc107, #fff);
  }
  
  .hero-artiste-card:hover {
    -webkit-transform: translateY(-0.25rem);
    transform: translateY(-0.25rem);
    border-color: #fff;
    box-shadow: 0 0.5rem 1.5rem rgba(255,193,7,0.6);
  }
  
  .hero-artiste-card h3 {
    margin: 0;
    font-size: 1.2rem;
    color: #000;
    font-weight: 700;
  }
  
  .hero-artiste-card .cta-hint-artiste {
    display: inline-block;
    padding: 0.5rem 1.25rem;
    background: #000;
    border: none;
    border-radius: 1.25rem;
    font-size: 0.9rem;
    color: #ffc107;
    font-weight: 700;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }
  
  .hero-artiste-card:hover .cta-hint-artiste {
    background: #222;
    -webkit-transform: scale(1.05);
    transform: scale(1.05);
  }
  
  @media (max-width: 768px) {
    .hero-artiste-card {
      flex-direction: column;
      gap: 0.75rem;
      padding: 1rem 1.5rem;
    }
    .hero-artiste-card h3 {
      font-size: 1rem;
    }
  }
</style>

<div class="hero-choice-section">
  <a href="{{ url_for('ecoles_themes') }}" class="hero-choice-card">
    <h2>√âcoles : votre projet p√©dagogique</h2>
    <div class="desc-box">
      <p>Nous vous trouvons le spectacle et les animations adapt√©s √† votre th√®me de l'ann√©e</p>
    </div>
    <span class="cta-hint">D√©couvrir l'offre ‚Üí</span>
  </a>
  
  <a href="{{ url_for('catalogue') }}" class="hero-choice-card">
    <h2>Mairie, √âcole, CSE... : trouver un spectacle</h2>
    <div class="desc-box">
      <p>Mairie, √©cole, CSE, association : publiez votre appel d'offre</p>
    </div>
    <span class="cta-hint">Parcourir le catalogue ‚Üí</span>
  </a>
</div>

<!-- Bloc Artiste/Compagnie - Deux colonnes -->
<div class="hero-artiste-section">
  <a href="{{ url_for('publish') }}" class="hero-artiste-card">
    <h3>üé≠ Artiste ou Compagnie ?</h3>
    <span class="cta-hint-artiste">Publier mon spectacle ‚Üí</span>
  </a>
  <a href="{{ url_for('abonnement_compagnie') }}" class="hero-artiste-card hero-abonnement">
    <h3>‚≠ê Abonnement Compagnie</h3>
    <span class="cta-hint-artiste">D√©couvrir les avantages ‚Üí</span>
  </a>
</div>

<style>
  .hero-artiste-section {
    display: flex;
    gap: 1.5rem;
    margin-top: 1rem;
  }
  
  .hero-artiste-section .hero-artiste-card {
    flex: 1;
    margin-top: 0;
  }
  
  .hero-abonnement {
    background: linear-gradient(135deg, #1a237e 0%, #283e5e 50%, #1976d2 100%) !important;
    border-color: #1976d2 !important;
    color: #fff !important;
    box-shadow: 0 0.375rem 1.25rem rgba(25,118,210,0.4) !important;
  }
  
  .hero-abonnement h3 {
    color: #fff !important;
  }
  
  .hero-abonnement .cta-hint-artiste {
    background: #ffc107 !important;
    color: #000 !important;
  }
  
  .hero-abonnement:hover {
    border-color: #ffc107 !important;
    box-shadow: 0 0.5rem 1.5rem rgba(25,118,210,0.6) !important;
  }
  
  @media (max-width: 768px) {
    .hero-artiste-section {
      flex-direction: column;
      gap: 1rem;
    }
  }
</style>

<!-- Section Chiffres Cl√©s avec animation -->
<section class="stats-section" style="background:linear-gradient(135deg,#162447 0%,#283e5e 100%); border-radius:12px; padding:20px 15px; margin:25px 0; box-shadow:0 2px 12px rgba(22,36,71,0.3);">
  <h2 style="text-align:center; color:#fff; margin-bottom:15px; font-size:1.1rem;">Nos chiffres cl√©s</h2>
  <div style="display:flex; flex-wrap:wrap; justify-content:center; gap:15px; max-width:800px; margin:0 auto;">
    
    <div style="text-align:center; flex:1; min-width:140px; padding:10px;">
      <p style="color:#FFDEDE; font-size:0.75rem; margin:0 0 4px 0; line-height:1.3;">d'exp√©rience dans<br>le spectacle</p>
      <div style="font-size:1.8rem; font-weight:800; color:#ffc107;">
        <span class="counter" data-target="30">0</span> <span style="font-size:1rem;">ans</span>
      </div>
    </div>
    
    <div style="text-align:center; flex:1; min-width:140px; padding:10px;">
      <p style="color:#FFDEDE; font-size:0.75rem; margin:0 0 4px 0; line-height:1.3;">Spectacles<br>programm√©s/an</p>
      <div style="font-size:1.8rem; font-weight:800; color:#ffc107;">
        <span style="font-size:1.2rem;">+</span><span class="counter" data-target="180">0</span>
      </div>
    </div>
    
    <div style="text-align:center; flex:1; min-width:140px; padding:10px;">
      <p style="color:#FFDEDE; font-size:0.75rem; margin:0 0 4px 0; line-height:1.3;">Artistes<br>r√©f√©renc√©s</p>
      <div style="font-size:1.8rem; font-weight:800; color:#ffc107;">
        <span style="font-size:1.2rem;">+</span><span class="counter" data-target="200">0</span>
      </div>
    </div>
    
    <div style="text-align:center; flex:1; min-width:140px; padding:10px;">
      <p style="color:#FFDEDE; font-size:0.75rem; margin:0 0 4px 0; line-height:1.3;">R√©ponse moyenne<br>devis</p>
      <div style="font-size:1.8rem; font-weight:800; color:#ffc107;">
        <span class="counter" data-target="3">0</span><span style="font-size:1rem;">h</span>
      </div>
    </div>
    
  </div>
</section>

<script>
// Animation des compteurs
(function() {
  const counters = document.querySelectorAll('.counter');
  const speed = 50; // Plus petit = plus rapide
  
  const animateCounter = (counter) => {
    const target = +counter.getAttribute('data-target');
    const increment = target / 100;
    let current = 1;
    
    const updateCount = () => {
      if (current < target) {
        current += increment;
        if (current > target) current = target;
        counter.innerText = Math.ceil(current);
        setTimeout(updateCount, speed);
      } else {
        counter.innerText = target;
      }
    };
    
    updateCount();
  };
  
  // Observer pour d√©clencher l'animation quand la section est visible
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        counters.forEach(counter => {
          counter.innerText = '1';
          animateCounter(counter);
        });
        observer.disconnect();
      }
    });
  }, { threshold: 0.3 });
  
  const statsSection = document.querySelector('.stats-section');
  if (statsSection) {
    observer.observe(statsSection);
  }
})();
</script>

<!-- Section Spectacles √† la Une -->
{% if spectacles_une %}
<style>
  .spectacles-une-section {
    max-width: 100%;
    margin: 32px auto 0 auto;
    padding: 0;
  }
  
  .spectacles-une-header {
    text-align: center;
    margin-bottom: 24px;
  }
  
  .spectacles-une-header h2 {
    font-size: 1.8rem;
    margin: 0 0 8px 0;
    color: var(--text);
  }
  
  .spectacles-une-header p {
    color: var(--muted);
    font-size: 1rem;
    margin: 0;
  }
</style>

<div class="spectacles-une-section">
  <div class="spectacles-une-header">
    <h2>‚ú® Spectacles √† la Une</h2>
    <p>D√©couvrez notre s√©lection de spectacles exceptionnels</p>
  </div>
  
  <div class="cards">
    {% for spectacle in spectacles_une %}
    <article class="card" style="border:2px solid #222;border-radius:16px;box-shadow:0 2px 12px #0008;padding:0 0 8px 0;transition:box-shadow .2s;color:#fff;">
      <a href="{{ url_for('show_detail', show_id=spectacle.id) }}" class="media-link">
        <div class="media">
          {% if spectacle.has_image() %}
            <img src="{{ url_for('uploaded_file', filename=spectacle.file_name) }}" alt="{{ spectacle.title }}">
          {% else %}
            <div class="placeholder">üé≠</div>
          {% endif %}
        </div>
      </a>
      
      <a href="{{ url_for('show_detail', show_id=spectacle.id) }}" class="content-link">
        <div class="content">
          <div style="margin-bottom:6px;">
            <span class="badge" style="background:linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color:#222; font-weight:700; border:none; font-size:0.75rem; padding:3px 8px; border-radius:10px;">
              ‚≠ê √Ä la une
            </span>
          </div>
          
          {% if spectacle.raison_sociale %}
            <p class="meta" style="font-weight:600; margin-bottom:8px; color:var(--primary); font-size:0.85em;">
              {{ spectacle.raison_sociale|title }}
            </p>
          {% endif %}
          
          <h3 style="margin:0 0 6px 0; line-height:1.2;">{{ spectacle.title }}</h3>
          
          <div style="display:flex; flex-direction:column; gap:4px; font-size:0.85em; margin-top:-2px;">
            {% if spectacle.age_range %}
            <div style="display:flex; align-items:center; gap:6px;">
              <span style="opacity:0.7; min-width:20px;">üë•</span>
              <span style="color:rgba(255,255,255,0.9);">{{ spectacle.age_range|format_age }}</span>
            </div>
            {% endif %}
          </div>
        </div>
      </a>
    </article>
    {% endfor %}
  </div>
  
  <div style="text-align:center; margin-top:24px;">
    <a href="{{ url_for('seo_category', category_slug='une') }}" 
       style="display:inline-flex; align-items:center; gap:8px; padding:12px 28px; background:linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color:#222; text-decoration:none; border-radius:25px; font-weight:700; font-size:1rem; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(255,215,0,0.4);">
      ‚≠ê Voir tous les spectacles √† la une <i class="fa fa-arrow-right"></i>
    </a>
  </div>
</div>
{% endif %}

{% endblock %}
