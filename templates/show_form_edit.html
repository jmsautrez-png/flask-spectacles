{% extends "base.html" %}
{% block title %}Compl√©ter le spectacle - AnimatoSpectacle{% endblock %}
{% block content %}
<h2>Compl√©ter le spectacle</h2>
<form method="post" enctype="multipart/form-data" class="form">
  <label>Raison sociale
    <input type="text" name="raison_sociale" value="{{ show.raison_sociale or '' }}">
  </label>

  <label>Titre
    <input type="text" name="title" value="{{ show.title }}" required>
  </label>
  
  <label>Description (max 200 mots)
    <textarea id="description" name="description" rows="4" required>{{ show.description or "" }}</textarea>
    <div id="desc-counter" style="font-size:.9rem;opacity:.8;margin-top:4px;">0/200 mots</div>
  </label>

  

      <label>Ville
        <input type="text" name="location" id="location-input" value="{{ show.location }}">
        <span style="font-size:0.95rem;color:#555;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une ville rapidement.</span>
        <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px; margin-top:6px;">
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #e67e2244;transition:all 0.2s;" onclick="addLocation('Paris')">Paris</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #8e44ad44;transition:all 0.2s;" onclick="addLocation('Marseille')">Marseille</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e74c3c44;transition:all 0.2s;" onclick="addLocation('Lyon')">Lyon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2980b9 0%,#6dd5fa 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2980b944;transition:all 0.2s;" onclick="addLocation('Toulouse')">Toulouse</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #16a08544;transition:all 0.2s;" onclick="addLocation('Nice')">Nice</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#f1c40f 0%,#f39c12 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #f1c40f44;transition:all 0.2s;" onclick="addLocation('Nantes')">Nantes</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2ecc71 0%,#27ae60 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2ecc7144;transition:all 0.2s;" onclick="addLocation('Montpellier')">Montpellier</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addLocation('Strasbourg')">Strasbourg</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addLocation('Bordeaux')">Bordeaux</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addLocation('Lille')">Lille</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addLocation('Rennes')">Rennes</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addLocation('Reims')">Reims</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addLocation('Le Havre')">Le Havre</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#ff7675 0%,#ffeaa7 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #ff767544;transition:all 0.2s;" onclick="addLocation('Saint-√âtienne')">Saint-√âtienne</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addLocation('Toulon')">Toulon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addLocation('Grenoble')">Grenoble</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addLocation('Dijon')">Dijon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addLocation('Angers')">Angers</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addLocation('Villeurbanne')">Villeurbanne</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addLocation('Saint-Denis')">Saint-Denis</button>
        </div>
      </label>
      <script>
        function addLocation(city) {
          var input = document.getElementById('location-input');
          var current = input.value.split(',').map(function(s){return s.trim();}).filter(Boolean);
          if (!current.includes(city)) {
            current.push(city);
            input.value = current.join(' | ');
          }
        }
      </script>

      <label>R√©gion
        <input type="text" name="region" id="region-input" value="{{ show.region or '' }}" placeholder="Ex: √éle-de-France, Bretagne...">
        <span style="font-size:0.95rem;color:#555;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une r√©gion rapidement.</span>
      </label>
      <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;">
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #e67e2244;transition:all 0.2s;" onclick="addRegion('Auvergne-Rh√¥ne-Alpes')">Auvergne-Rh√¥ne-Alpes</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #8e44ad44;transition:all 0.2s;" onclick="addRegion('Bourgogne-Franche-Comt√©')">Bourgogne-Franche-Comt√©</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e74c3c44;transition:all 0.2s;" onclick="addRegion('Bretagne')">Bretagne</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2980b9 0%,#6dd5fa 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2980b944;transition:all 0.2s;" onclick="addRegion('Centre-Val de Loire')">Centre-Val de Loire</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #16a08544;transition:all 0.2s;" onclick="addRegion('Corse')">Corse</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#f1c40f 0%,#f39c12 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #f1c40f44;transition:all 0.2s;" onclick="addRegion('Grand Est')">Grand Est</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2ecc71 0%,#27ae60 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2ecc7144;transition:all 0.2s;" onclick="addRegion('Hauts-de-France')">Hauts-de-France</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addRegion('√éle-de-France')">√éle-de-France</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addRegion('Normandie')">Normandie</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addRegion('Nouvelle-Aquitaine')">Nouvelle-Aquitaine</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addRegion('Occitanie')">Occitanie</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addRegion('Pays de la Loire')">Pays de la Loire</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addRegion('Provence-Alpes-C√¥te d\'Azur')">Provence-Alpes-C√¥te d'Azur</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#ff7675 0%,#ffeaa7 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #ff767544;transition:all 0.2s;" onclick="addRegion('Guadeloupe')">Guadeloupe</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addRegion('Martinique')">Martinique</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addRegion('Guyane')">Guyane</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addRegion('La R√©union')">La R√©union</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addRegion('Mayotte')">Mayotte</button>
      </div>
    <script>
      function addRegion(region) {
        var input = document.getElementById('region-input');
        var current = input.value.split(',').map(function(s){return s.trim();}).filter(Boolean);
        if (!current.includes(region)) {
          current.push(region);
          input.value = current.join(' | ');
        }
      }
    </script>
   </div>

  <label>Cat√©gorie
    <input type="text" name="category" id="category-input" value="{{ show.category }}">
    <span style="font-size:0.95rem;color:#555;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une cat√©gorie rapidement.</span>
  </label>
  <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;">
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #e67e2244;transition:all 0.2s;" onclick="addCategory('Marionnette')">Marionnette</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #8e44ad44;transition:all 0.2s;" onclick="addCategory('Magie')">Magie</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e74c3c44;transition:all 0.2s;" onclick="addCategory('Clown')">Clown</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2980b9 0%,#6dd5fa 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2980b944;transition:all 0.2s;" onclick="addCategory('Th√©√¢tre')">Th√©√¢tre</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #16a08544;transition:all 0.2s;" onclick="addCategory('Spectacle enfant')">Spectacle enfant</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#f1c40f 0%,#f39c12 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #f1c40f44;transition:all 0.2s;" onclick="addCategory('Atelier')">Atelier</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2ecc71 0%,#27ae60 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2ecc7144;transition:all 0.2s;" onclick="addCategory('Concert')">Concert</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addCategory('Cirque')">Cirque</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addCategory('Spectacle de rue')">Spectacle de rue</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addCategory('Orchestre')">Orchestre</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addCategory(`Arbre de No√´l`)">Arbre de No√´l</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addCategory(`Animation √©cole`)">Animation √©cole</button>
    <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addCategory(`F√™te de village`)">F√™te de village</button>
  </div>
  <script>
    function addCategory(cat) {
      var input = document.getElementById('category-input');
      var current = input.value.split(',').map(function(s){return s.trim();}).filter(Boolean);
      if (!current.includes(cat)) {
        current.push(cat);
        input.value = current.join(' | ');
      }
    }
  </script>

  <!-- Champ cat√©gorie 2 supprim√© (nettoy√©) -->
   

  <label>√Çge
    <select name="age_range" required>
      <option value="">-- Choisir --</option>
      <option value="enfant_2_6" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_2_6' %}selected{% endif %}>Enfant (2/6 ans)</option>
      <option value="enfant_6_10" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_6_10' %}selected{% endif %}>Enfant (6/10 ans)</option>
      <option value="enfant_2_10" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_2_10' %}selected{% endif %}>Enfant (2/10 ans)</option>
      <option value="adolescent" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'adolescent' %}selected{% endif %}>Adolescent</option>
      <option value="adulte" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'adulte' %}selected{% endif %}>Adulte</option>
      <option value="tout public" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'tout public' %}selected{% endif %}>Tout public</option>
    </select>
  </label>

  <label>Site internet
    <input type="url" name="site_internet" placeholder="https://spectacleanimation.fr/" value="{{ request.form.get('site_internet', 'https://spectacleanimation.fr/') }}">
    <span style="font-size:0.95rem;color:#fff;font-weight:bold;display:block;margin-top:2px;">(visible si abonnement)</span>
  </label>

  <label>Email de contact <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(Modifiable uniquement par l'admin)</span>
    <input type="email" name="contact_email" value="{{ request.form.get('contact_email', 'contact@spectacleanimation.fr') }}">
    <span style="font-size:0.95rem;color:#fff;font-weight:bold;display:block;margin-top:2px;">(visible si abonnement)</span>
  </label>

  <label>T√©l√©phone de contact <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(visible uniquement par l'administrateur)</span>
    <input type="tel" name="contact_phone" value="{{ show.contact_phone or '06 76 07 01 79' }}" placeholder="06 76 07 01 79">
  </label>

  {% if show.file_name %}
    {% if show.is_pdf() %}
        <p>Fichier actuel :
            <a href="{{ url_for('uploaded_file', filename=show.file_name) }}" target="_blank">
                üìÑ Voir le PDF ({{ show.file_name }})
            </a>
        </p>
    {% else %}
        <p>Image actuelle :</p>
        <img src="{{ url_for('uploaded_file', filename=show.file_name) }}"
             alt="{{ show.title }}"
             class="show-image">
    {% endif %}
{% else %}
    <p><em>Aucun fichier associ√© pour l‚Äôinstant.</em></p>
{% endif %}



  <label>Remplacer l'image ou le PDF <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(Taille max : 5 MB)</span>
    <input type="file" name="file" accept=".png,.jpg,.jpeg,.gif,.webp,.pdf">
  </label>

  <div class="actions">
    <button type="submit">Mettre √† jour</button>
    <a class="btn-secondary" href="{{ url_for('home') }}">Annuler</a>
    <a class="btn-secondary" href="{{ url_for('company_dashboard') }}" style="margin-left:8px;">Retour au tableau de bord</a>
  </div>
</form>


<!-- Script limite 200 mots -->
<script>
(function () {
  const ta = document.getElementById('description');
  const counter = document.getElementById('desc-counter');
  const MAX = 200;

  if (!ta || !counter) return;

  function update() {
    const words = ta.value.trim().split(/\s+/).filter(Boolean);
    if (words.length > MAX) {
      ta.value = words.slice(0, MAX).join(' ');
    }
    const count = ta.value.trim() ? ta.value.trim().split(/\s+/).length : 0;
    counter.textContent = `${count}/${MAX} mots`;
  }

  ta.addEventListener('input', update);
  update(); // initialiser le compteur

  document.querySelectorAll("form").forEach(form => {
    form.addEventListener("submit", e => {
      const words = ta.value.trim().split(/\s+/).filter(Boolean);
      if (words.length > MAX) {
        e.preventDefault();
        alert("La description ne doit pas d√©passer 70 mots.");
      }
    });
  });
})();
</script>
{% endblock %}
