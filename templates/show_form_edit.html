  <label>Email de contact <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(Modifiable uniquement par l'admin)</span>
    {% if user and user.is_admin %}
      <input type="email" name="contact_email" value="{{ request.form.get('contact_email', 'contact@spectacleanimation.fr') }}">
    {% else %}
      <input type="email" name="contact_email" value="{{ request.form.get('contact_email', 'contact@spectacleanimation.fr') }}" readonly style="background:#eee; color:#888; cursor:not-allowed;">
    {% endif %}
  </label>

  <label>T√©l√©phone de contact <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(Modifiable uniquement par l'admin)</span>
    {% if user and user.is_admin %}
      <input type="tel" name="contact_phone" value="{{ show.contact_phone or '06 76 07 01 79' }}" placeholder="06 76 07 01 79">
    {% else %}
      <input type="tel" name="contact_phone" value="{{ show.contact_phone or '06 76 07 01 79' }}" placeholder="06 76 07 01 79" readonly style="background:#eee; color:#888; cursor:not-allowed;">
    {% endif %}
  </label>

  <label>Site internet <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(Modifiable uniquement par l'admin)</span>
    {% if user and user.is_admin %}
      <input type="url" name="site_internet" placeholder="https://spectacleanimation.fr/" value="{{ request.form.get('site_internet', 'https://spectacleanimation.fr/') }}">
    {% else %}
      <input type="url" name="site_internet" placeholder="https://spectacleanimation.fr/" value="{{ request.form.get('site_internet', 'https://spectacleanimation.fr/') }}" readonly style="background:#eee; color:#888; cursor:not-allowed;">
    {% endif %}
  </label>
{% extends "base.html" %}
{% block title %}Compl√©ter le spectacle - AnimatoSpectacle{% endblock %}
{% block content %}
<h2>Compl√©ter le spectacle</h2>
<form method="post" enctype="multipart/form-data" class="form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
  <label>Raison sociale
    <input type="text" name="raison_sociale" value="{{ show.raison_sociale or '' }}">
  </label>

  <label>Titre
    <input type="text" name="title" value="{{ show.title }}" required>
  </label>
  
  <label>Description (max 300 mots)
    <textarea id="description" name="description" rows="4" required>{{ show.description or "" }}</textarea>
    <div id="desc-counter" style="font-size:.9rem;opacity:.8;margin-top:4px;">0/300 mots</div>
  </label>

  

      <label>Ville
        <input type="text" name="location" id="location-input" value="{{ show.location }}">
        <span style="font-size:0.95rem;color:#fff;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une ville rapidement (vous pouvez ajouter jusqu'√† 10 villes).</span>
        <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px; margin-top:6px;">
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #e67e2244;transition:all 0.2s;" onclick="addLocation('Paris')">Paris</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #8e44ad44;transition:all 0.2s;" onclick="addLocation('Marseille')">Marseille</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e74c3c44;transition:all 0.2s;" onclick="addLocation('Lyon')">Lyon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2980b9 0%,#6dd5fa 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2980b944;transition:all 0.2s;" onclick="addLocation('Toulouse')">Toulouse</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #16a08544;transition:all 0.2s;" onclick="addLocation('Nice')">Nice</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#f1c40f 0%,#f39c12 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #f1c40f44;transition:all 0.2s;" onclick="addLocation('Nantes')">Nantes</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2ecc71 0%,#27ae60 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2ecc7144;transition:all 0.2s;" onclick="addLocation('Montpellier')">Montpellier</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addLocation('Strasbourg')">Strasbourg</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addLocation('Bordeaux')">Bordeaux</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addLocation('Lille')">Lille</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addLocation('Rennes')">Rennes</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addLocation('Reims')">Reims</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addLocation('Le Havre')">Le Havre</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#ff7675 0%,#ffeaa7 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #ff767544;transition:all 0.2s;" onclick="addLocation('Saint-√âtienne')">Saint-√âtienne</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addLocation('Toulon')">Toulon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addLocation('Grenoble')">Grenoble</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addLocation('Dijon')">Dijon</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addLocation('Angers')">Angers</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addLocation('Villeurbanne')">Villeurbanne</button>
          <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addLocation('Saint-Denis')">Saint-Denis</button>
        </div>
      </label>
      <script>
        function addLocation(city) {
          var input = document.getElementById('location-input');
          var current = input.value.split('|').map(function(s){return s.trim();}).filter(Boolean);
          if (current.length >= 10) {
            alert('‚ö†Ô∏è Vous ne pouvez pas ajouter plus de 10 villes (limite technique de 500 caract√®res).');
            return;
          }
          if (!current.includes(city)) {
            current.push(city);
            input.value = current.join(' | ');
          }
        }
      </script>

      <label>R√©gion
        <input type="text" name="region" id="region-input" value="{{ show.region or '' }}" placeholder="Ex: √éle-de-France, Bretagne...">
        <span style="font-size:0.95rem;color:#fff;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une r√©gion rapidement (vous pouvez ajouter jusqu'√† 10 r√©gions).</span>
      </label>
      <div style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;">
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #e67e2244;transition:all 0.2s;" onclick="addRegion('Auvergne-Rh√¥ne-Alpes')">Auvergne-Rh√¥ne-Alpes</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #8e44ad44;transition:all 0.2s;" onclick="addRegion('Bourgogne-Franche-Comt√©')">Bourgogne-Franche-Comt√©</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e74c3c44;transition:all 0.2s;" onclick="addRegion('Bretagne')">Bretagne</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2980b9 0%,#6dd5fa 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2980b944;transition:all 0.2s;" onclick="addRegion('Centre-Val de Loire')">Centre-Val de Loire</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #16a08544;transition:all 0.2s;" onclick="addRegion('Corse')">Corse</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#f1c40f 0%,#f39c12 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #f1c40f44;transition:all 0.2s;" onclick="addRegion('Grand Est')">Grand Est</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#2ecc71 0%,#27ae60 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #2ecc7144;transition:all 0.2s;" onclick="addRegion('Hauts-de-France')">Hauts-de-France</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #e8439344;transition:all 0.2s;" onclick="addRegion('√éle-de-France')">√éle-de-France</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #34495e44;transition:all 0.2s;" onclick="addRegion('Normandie')">Normandie</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addRegion('Nouvelle-Aquitaine')">Nouvelle-Aquitaine</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addRegion('Occitanie')">Occitanie</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addRegion('Pays de la Loire')">Pays de la Loire</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addRegion('Provence-Alpes-C√¥te d\'Azur')">Provence-Alpes-C√¥te d'Azur</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#ff7675 0%,#ffeaa7 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #ff767544;transition:all 0.2s;" onclick="addRegion('Guadeloupe')">Guadeloupe</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00b89444;transition:all 0.2s;" onclick="addRegion('Martinique')">Martinique</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#fdcb6e 0%,#e17055 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #fdcb6e44;transition:all 0.2s;" onclick="addRegion('Guyane')">Guyane</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#00bfff 0%,#0984e3 100%);color:#fff;font-weight:600;border:none;box-shadow:0 2px 8px #00bfff44;transition:all 0.2s;" onclick="addRegion('La R√©union')">La R√©union</button>
        <button type="button" style="min-width:120px;flex:1 1 120px;padding:8px 6px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#222;font-weight:600;border:none;box-shadow:0 2px 8px #636e7244;transition:all 0.2s;" onclick="addRegion('Mayotte')">Mayotte</button>
      </div>
    <script>
      function addRegion(region) {
        var input = document.getElementById('region-input');
        var current = input.value.split('|').map(function(s){return s.trim();}).filter(Boolean);
        if (current.length >= 10) {
          alert('‚ö†Ô∏è Vous ne pouvez pas ajouter plus de 10 r√©gions (limite technique de 500 caract√®res).');
          return;
        }
        if (!current.includes(region)) {
          current.push(region);
          input.value = current.join(' | ');
        }
      }
    </script>
   </div>

  <label>Cat√©gorie
    <input type="text" name="category" id="category-input" value="{{ show.category }}">
    <span style="font-size:0.95rem;color:#fff;display:block;margin-top:2px;margin-bottom:4px;">Cliquez sur un bouton pour ajouter une cat√©gorie rapidement (vous pouvez ajouter jusqu'√† 10 cat√©gories).</span>
  </label>
  <div style="background:linear-gradient(135deg,#1b2a4e 0%,#355c7d 100%);border:2px solid #355c7d;border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 4px 12px rgba(53,92,125,0.3);">
    <div style="font-weight:700;color:#fff;margin-bottom:10px;font-size:1rem;text-align:center;background:linear-gradient(90deg,#1b2a4e 0%,#355c7d 100%);padding:8px;border-radius:8px;box-shadow:0 2px 6px rgba(27,42,78,0.3);">Spectacle et Animation Artistique</div>
    <div style="display:flex;flex-wrap:wrap;gap:6px;">
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(142,68,173,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Animation et Atelier Artistique')">Animation et Atelier Artistique</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#3498db 0%,#2980b9 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(52,152,219,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Atelier divers')">Atelier divers</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#9b59b6 0%,#8e44ad 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(155,89,182,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Atelier maquillage')">Atelier maquillage</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#16a085 0%,#1abc9c 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(22,160,133,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Caricaturistes et Silhouettiste')">Caricaturistes et Silhouettiste</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#e84393 0%,#fd79a8 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(232,67,147,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Cirque')">Cirque</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(231,76,60,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Clown')">Clown</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#8d6e63 0%,#6d4c41 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(141,110,99,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Conte et Th√©√¢tre')">Conte et Th√©√¢tre</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#636e72 0%,#b2bec3 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(99,110,114,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('F√™te de village')">F√™te de village</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#f39c12 0%,#e67e22 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(243,156,18,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Humoriste et Imitateur')">Humoriste et Imitateur</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#95a5a6 0%,#7f8c8d 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(149,165,166,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Location de stand')">Location de stand</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(142,68,173,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Magie et Magicien')">Magie et Magicien</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#e67e22 0%,#f6e58d 100%);color:#222;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(230,126,34,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Man√®ge')">Man√®ge</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#f39c12 0%,#e67e22 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(243,156,18,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Marionnettes')">Marionnettes</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#c0392b 0%,#e74c3c 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(192,57,43,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('P√®re No√´l')">P√®re No√´l</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#e91e63 0%,#ad1457 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(233,30,99,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Revue Cabaret et Danse')">Revue Cabaret et Danse</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#9c27b0 0%,#7b1fa2 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(156,39,176,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Sosie')">Sosie</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#673ab7 0%,#512da8 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(103,58,183,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle √† Th√®mes')">Spectacle √† Th√®mes</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#4caf50 0%,#388e3c 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(76,175,80,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle Animalier')">Spectacle Animalier</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#388e3c 0%,#1b5e20 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(56,142,60,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle Arbre de No√´l')">Spectacle Arbre de No√´l</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#ec407a 0%,#ad1457 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(236,64,122,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle de danse')">Spectacle de danse</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#607d8b 0%,#455a64 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(96,125,139,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle de Rue')">Spectacle de Rue</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#43a047 0%,#2e7d32 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(67,160,71,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle Enfants')">Spectacle Enfants</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#66bb6a 0%,#43a047 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(102,187,106,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle √©cole maternelle ou √©l√©mentaire')">Spectacle √©cole maternelle ou √©l√©mentaire</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#26a69a 0%,#00897b 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(38,166,154,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle coll√®ge ou lyc√©e')">Spectacle coll√®ge ou lyc√©e</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#1976d2 0%,#1565c0 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(25,118,210,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle Ev√©nementiel')">Spectacle Ev√©nementiel</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#00acc1 0%,#00838f 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(0,172,193,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Spectacle Musical')">Spectacle Musical</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#5e35b1 0%,#4527a0 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(94,53,177,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Ventriloque')">Ventriloque</button>
    </div>
  </div>
  <div style="background:linear-gradient(135deg,#1b2a4e 0%,#355c7d 100%);border:2px solid #355c7d;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 4px 12px rgba(53,92,125,0.3);">
    <div style="font-weight:700;color:#fff;margin-bottom:10px;font-size:1rem;text-align:center;background:linear-gradient(90deg,#1b2a4e 0%,#355c7d 100%);padding:8px;border-radius:8px;box-shadow:0 2px 6px rgba(27,42,78,0.3);">Groupe de Musique et Musicien</div>
    <div style="display:flex;flex-wrap:wrap;gap:6px;">
      {% if user and user.is_admin %}
      <button type="button" style="padding:10px 18px;border-radius:10px;background:linear-gradient(135deg,#dc143c 0%,#b01030 100%);color:#fff;font-weight:700;border:none;font-size:1rem;box-shadow:0 4px 10px rgba(220,20,60,0.5);transition:all 0.2s;cursor:pointer;letter-spacing:0.5px;" onclick="addCategory('Spectacle √† la Une')">‚≠ê Spectacle √† la Une</button>
      {% endif %}
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#ff6f00 0%,#e65100 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(255,111,0,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Accord√©oniste')">Accord√©oniste</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#ffa726 0%,#fb8c00 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(255,167,38,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Animation Musicale')">Animation Musicale</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#9c27b0 0%,#7b1fa2 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(156,39,176,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Chorale et Gospel')">Chorale et Gospel</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#00b894 0%,#00cec9 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(0,184,148,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('D.J. et Orchestre')">D.J. et Orchestre</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#f39c12 0%,#e67e22 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(243,156,18,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Fanfare et Batucada')">Fanfare et Batucada</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#d35400 0%,#ba4a00 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(211,84,0,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Groupe folklorique')">Groupe folklorique</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#34495e 0%,#2c3e50 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(52,73,94,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Jazz')">Jazz</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#8e44ad 0%,#6c3483 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(142,68,173,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Musique Classique')">Musique Classique</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#c0392b 0%,#a93226 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(192,57,43,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Orgue de Barbarie')">Orgue de Barbarie</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#2c3e50 0%,#1a252f 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(44,62,80,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Pianiste')">Pianiste</button>
      <button type="button" style="padding:7px 14px;border-radius:8px;background:linear-gradient(135deg,#e74c3c 0%,#c0392b 100%);color:#fff;font-weight:600;border:none;font-size:0.9rem;box-shadow:0 2px 6px rgba(231,76,60,0.4);transition:all 0.2s;cursor:pointer;" onclick="addCategory('Rock et Country')">Rock et Country</button>
    </div>
  </div>
  <script>
    function addCategory(cat) {
      var input = document.getElementById('category-input');
      var current = input.value.split('|').map(function(s){return s.trim();}).filter(Boolean);
      if (current.length >= 10) {
        alert('‚ö†Ô∏è Vous ne pouvez pas ajouter plus de 10 cat√©gories (limite technique de 500 caract√®res).');
        return;
      }
      if (!current.includes(cat)) {
        current.push(cat);
        input.value = current.join(' | ');
      }
    }
  </script>

  <!-- Champ cat√©gorie 2 supprim√© (nettoy√©) -->
   

  <label>√Çge
    <select name="age_range" required>
      <option value="">-- Choisir --</option>
      <option value="familial" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'familial' %}selected{% endif %}>Familial</option>
      <option value="enfant" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant' %}selected{% endif %}>Enfant</option>
      <option value="enfant_2_6" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_2_6' %}selected{% endif %}>Enfant (2/6 ans)</option>
      <option value="enfant_6_10" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_6_10' %}selected{% endif %}>Enfant (6/10 ans)</option>
      <option value="enfant_2_10" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'enfant_2_10' %}selected{% endif %}>Enfant (2/10 ans)</option>
      <option value="adolescent" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'adolescent' %}selected{% endif %}>Adolescent</option>
      <option value="adulte" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'adulte' %}selected{% endif %}>Adulte</option>
      <option value="tout public" {% if (request.form.get('age_range') if request.method=='POST' else (show.age_range if show else '')) == 'tout public' %}selected{% endif %}>Tout public</option>
    </select>
  </label>

  <label>Site internet
    <input type="url" name="site_internet" placeholder="https://www.monsite.fr" value="{{ show.site_internet if show and show.site_internet else '' }}">
    <span style="font-size:0.95rem;color:#fff;font-weight:bold;display:block;margin-top:2px;">(visible si abonnement)</span>
  </label>

  <label>Email de contact
    <input type="email" name="contact_email" placeholder="votre@email.fr" value="{{ show.contact_email if show and show.contact_email else '' }}" required>
    <span style="font-size:0.95rem;color:#fff;font-weight:bold;display:block;margin-top:2px;">(visible si abonnement)</span>
  </label>

  <label>T√©l√©phone de contact <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(visible uniquement par l'administrateur)</span>
    <input type="tel" name="contact_phone" value="{{ show.contact_phone if show and show.contact_phone else '' }}" placeholder="06 12 34 56 78">
  </label>

  {% if user and user.is_admin %}
  <div style="background:linear-gradient(135deg,#e91e63 0%,#9c27b0 100%);border-radius:12px;padding:16px;margin:16px 0;box-shadow:0 4px 15px rgba(233,30,99,0.3);">
    <label style="display:flex;align-items:center;gap:12px;cursor:pointer;color:#fff;font-weight:600;">
      <input type="checkbox" name="is_event" value="1" {% if show and show.is_event %}checked{% endif %} style="width:20px;height:20px;cursor:pointer;">
      <span>üìÖ Marquer comme √©v√©nement annonc√©</span>
    </label>
    <p style="margin:8px 0 0 32px;font-size:0.9rem;color:rgba(255,255,255,0.8);">
      Les √©v√©nements sont affich√©s dans la section "√âv√©nements annonc√©s" et non dans le catalogue principal.
    </p>
    
    <label style="display:block;margin-top:16px;color:#fff;font-weight:600;">
      üìÜ Date de l'√©v√©nement
      <input type="date" name="date" value="{{ show.date.strftime('%Y-%m-%d') if show and show.date else '' }}" style="display:block;margin-top:8px;padding:10px 14px;border-radius:8px;border:none;font-size:1rem;width:100%;max-width:250px;">
    </label>
  </div>
  {% endif %}

  {% if show.file_name %}
    {% if show.is_pdf() %}
        <p>Fichier actuel :
            <a href="{{ url_for('uploaded_file', filename=show.file_name) }}" target="_blank">
                üìÑ Voir le PDF ({{ show.file_name }})
            </a>
        </p>
    {% else %}
        <p>Photos actuelles :</p>
        <div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; margin-bottom:16px;">
          <div style="text-align:center;">
            <span style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:6px;">Photo 1 (principale)</span>
            <img src="{{ url_for('uploaded_file', filename=show.file_name) }}"
                 alt="{{ show.title }}"
                 style="max-width:100%; max-height:150px; border-radius:8px; border:1px solid var(--border);">
          </div>
          {% if show.has_image2() %}
          <div style="text-align:center;">
            <span style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:6px;">Photo 2</span>
            <img src="{{ url_for('uploaded_file', filename=show.file_name2) }}"
                 alt="{{ show.title }} - Photo 2"
                 style="max-width:100%; max-height:150px; border-radius:8px; border:1px solid var(--border);">
          </div>
          {% else %}
          <div style="text-align:center; opacity:0.5;">
            <span style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:6px;">Photo 2</span>
            <div style="height:100px; background:var(--bg); border-radius:8px; border:1px dashed var(--border); display:flex; align-items:center; justify-content:center; color:var(--muted);">Non d√©finie</div>
          </div>
          {% endif %}
          {% if show.has_image3() %}
          <div style="text-align:center;">
            <span style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:6px;">Photo 3</span>
            <img src="{{ url_for('uploaded_file', filename=show.file_name3) }}"
                 alt="{{ show.title }} - Photo 3"
                 style="max-width:100%; max-height:150px; border-radius:8px; border:1px solid var(--border);">
          </div>
          {% else %}
          <div style="text-align:center; opacity:0.5;">
            <span style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:6px;">Photo 3</span>
            <div style="height:100px; background:var(--bg); border-radius:8px; border:1px dashed var(--border); display:flex; align-items:center; justify-content:center; color:var(--muted);">Non d√©finie</div>
          </div>
          {% endif %}
        </div>
    {% endif %}
{% else %}
    <p><em>Aucun fichier associ√© pour l‚Äôinstant.</em></p>
{% endif %}



  <!-- Upload de 3 photos pour le diaporama -->
  <div style="margin-bottom:16px;">
    <span style="font-weight:600; display:block; margin-bottom:12px;">Remplacer ou ajouter des photos <span style="font-size:0.85rem;font-weight:normal;color:var(--muted);">(jusqu'√† 3 photos - Taille max : 5 MB chacune)</span></span>
    <small style="display:block; margin-bottom:12px; color:var(--muted);">Les photos s'afficheront en diaporama sur votre carte. Formats accept√©s : PNG, JPG, GIF, WEBP ou PDF.</small>
    
    <div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:12px;">
      <label style="display:flex; flex-direction:column; gap:6px;">
        <span style="font-size:0.85rem; color:var(--muted);">Photo 1 (principale)</span>
        <input type="file" name="file" accept=".png,.jpg,.jpeg,.gif,.webp,.pdf" style="padding:8px; background:var(--bg); border:1px solid var(--border); border-radius:8px;">
      </label>
      <label style="display:flex; flex-direction:column; gap:6px;">
        <span style="font-size:0.85rem; color:var(--muted);">Photo 2</span>
        <input type="file" name="file2" accept=".png,.jpg,.jpeg,.gif,.webp" style="padding:8px; background:var(--bg); border:1px solid var(--border); border-radius:8px;">
      </label>
      <label style="display:flex; flex-direction:column; gap:6px;">
        <span style="font-size:0.85rem; color:var(--muted);">Photo 3</span>
        <input type="file" name="file3" accept=".png,.jpg,.jpeg,.gif,.webp" style="padding:8px; background:var(--bg); border:1px solid var(--border); border-radius:8px;">
      </label>
    </div>
  </div>

  <div class="actions">
    <button type="submit">Mettre √† jour</button>
    <a class="btn-secondary" href="{{ url_for('home') }}">Annuler</a>
    <a class="btn-secondary" href="{{ url_for('company_dashboard') }}" style="margin-left:8px;">Retour au tableau de bord</a>
  </div>
</form>


<!-- Script limite 300 mots -->
<script>
(function () {
  const ta = document.getElementById('description');
  const counter = document.getElementById('desc-counter');
  const MAX = 300;

  if (!ta || !counter) return;

  function update() {
    const words = ta.value.trim().split(/\s+/).filter(Boolean);
    if (words.length > MAX) {
      ta.value = words.slice(0, MAX).join(' ');
    }
    const count = ta.value.trim() ? ta.value.trim().split(/\s+/).length : 0;
    counter.textContent = `${count}/${MAX} mots`;
  }

  ta.addEventListener('input', update);
  update(); // initialiser le compteur

  document.querySelectorAll("form").forEach(form => {
    form.addEventListener("submit", e => {
      const words = ta.value.trim().split(/\s+/).filter(Boolean);
      if (words.length > MAX) {
        e.preventDefault();
        alert("La description ne doit pas d√©passer 70 mots.");
      }
    });
  });
})();
</script>
{% endblock %}
