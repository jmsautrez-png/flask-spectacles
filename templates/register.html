{% extends "base.html" %}
{% block title %}Créer un compte - Spectacle'ment VØtre{% endblock %}

{% block content %}
<div class="demande-wrap" style="max-width:700px;">
  <h1 style="margin:0 0 8px 0;">Créer un compte</h1>
  <p class="text-muted" style="margin:0 0 16px 0;">
    Inscrivez-vous gratuitement pour publier vos spectacles et animations. Les champs marqués <span style="color:var(--primary); font-weight:700;">*</span> sont obligatoires.
  </p>

  <div style="background:#fffde7;border:1px solid #ffe082;padding:14px 18px;margin-bottom:20px;border-radius:10px;font-size:0.95rem;line-height:1.6;color:#795548;">
    <strong>• Publication 100 % gratuite et visibilité renforcée :</strong> vØtre spectacle est mis en ligne sans frais, avec un placement privilégié auprès de notre réseau d'acheteurs. Notre équipe s'occupe ensuite des demandes, des contacts et des ventes, sans commission tant qu'aucune réservation n'est conclue.<br>
    • Diffusion gratuite de vos projets auprès de plus de 100 000 contacts professionnels grâce à des campagnes de mails annuelles.
  </div>

  <form method="post" class="form demande-form" novalidate>
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    
    <fieldset class="demande-section">
      <legend>Identifiants</legend>

      <div class="grid-2">
        <label>
          <span class="label-text">Nom d'utilisateur <span class="req">*</span></span>
          <input type="text" name="username" required placeholder="Votre nom d'utilisateur"
                 value="{{ request.form.get('username','') }}">
        </label>

        <label>
          <span class="label-text">Email <span class="req">*</span></span>
          <input type="email" name="email" required placeholder="votre@email.fr"
                 value="{{ request.form.get('email','') }}">
        </label>
      </div>

      <label style="margin-bottom:0; position:relative;">
        <span class="label-text">Mot de passe <span class="req">*</span></span>
        <input type="password" name="password" id="register-password" required placeholder="Choisissez un mot de passe sécurisé" style="padding-right:38px;">
        <span onclick="togglePasswordRegister()" style="position:absolute; right:10px; top:38px; cursor:pointer; color:#1976d2; font-size:1.2em; user-select:none;" title="Afficher/masquer le mot de passe">
          <svg id="eye-register" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/><circle id="eye-dot-register" cx="12" cy="12" r="3" fill="currentColor"/></svg>
        </span>
      </label>
    <script>
    function togglePasswordRegister() {
      const input = document.getElementById('register-password');
      const eye = document.getElementById('eye-register');
      if (input.type === 'password') {
        input.type = 'text';
        eye.style.opacity = 0.5;
      } else {
        input.type = 'password';
        eye.style.opacity = 1;
      }
    }
    </script>
    </fieldset>

    <fieldset class="demande-section">
      <legend>Informations complémentaires</legend>

      <div class="grid-2">
        <label>
          <span class="label-text">Téléphone</span>
          <input type="text" name="telephone" placeholder="06 00 00 00 00"
                 value="{{ request.form.get('telephone','') }}">
        </label>

        <label>
          <span class="label-text">Raison sociale</span>
          <input type="text" name="raison_sociale" placeholder="Nom de votre compagnie"
                 value="{{ request.form.get('raison_sociale','') }}">
        </label>
      </div>

      

        <label>
          <span class="label-text">Région</span>
          <input type="text" name="region" id="region-input" placeholder="Ex: Île-de-France"
                 value="{{ request.form.get('region','') }}">
        </label>

        <div style="background:#e3f2fd; color:#1565c0; border:1px solid #90caf9; border-radius:7px; padding:7px 12px; margin:10px 0 8px 0; font-size:0.97em; font-weight:500;">
          Cliquez sur une région pour remplir automatiquement le champ ci-dessus&nbsp;:
        </div>
        <!-- Bandeau supprimé -->
        <div class="region-buttons" style="display:flex; flex-wrap:wrap; gap:6px; margin-bottom:14px; position:relative; border-radius:8px; border:1px solid #1976d2; background:linear-gradient(135deg,#162447 0%,#283e5e 100%); padding:12px 0 6px 0;">
          <div id="region-hover-banner" style="display:none; position:absolute; left:0; right:0; top:-38px; background:#fffde7; color:#795548; border:1px solid #ffe082; border-radius:7px; padding:7px 12px; font-size:0.97em; font-weight:500; z-index:10; text-align:center; pointer-events:none; transition:opacity 0.2s; opacity:0;">
            Cliquez pour sélectionner cette région
          </div>
          {% set regions = [
            'Auvergne-Rhône-Alpes', 'Bourgogne-Franche-Comté', 'Bretagne', 'Centre-Val de Loire',
            'Corse', 'Grand Est', 'Hauts-de-France', 'Île-de-France', 'Normandie',
            'Nouvelle-Aquitaine', 'Occitanie', 'Pays de la Loire', 'Provence-Alpes-Côte d\'Azur',
            'Guadeloupe', 'Martinique', 'Guyane', 'La Réunion', 'Mayotte'
          ] %}
          {% set region_colors = [
            '#e67e22', '#8e44ad', '#e74c3c', '#2980b9', '#16a085', '#f1c40f', '#2ecc71', '#e84393',
            '#34495e', '#00b894', '#fdcb6e', '#00bfff', '#636e72', '#ff7675', '#00cec9', '#e17055', '#0984e3', '#b2bec3'
          ] %}
          {% for reg in regions %}
            {% set color = region_colors[loop.index0 % region_colors|length] %}
            <button type="button" class="btn-region" style="padding:4px 10px; border-radius:5px; border:1px solid {{ color }}; background:linear-gradient(135deg,{{ color }} 0%,#fff 100%); color:#222; font-size:0.95em; cursor:pointer; font-weight:600; box-shadow:0 2px 8px {{ color }}44; transition:all 0.2s;"
              onmouseover="document.getElementById('region-hover-banner').style.display='block'; document.getElementById('region-hover-banner').style.opacity='1';"
              onmouseout="document.getElementById('region-hover-banner').style.opacity='0'; setTimeout(function(){document.getElementById('region-hover-banner').style.display='none';},200);"
              onclick="document.getElementById('region-input').value='{{ reg }}'"
            >{{ reg }}</button>
          {% endfor %}
        </div>

        <label>
          <span class="label-text">Site internet</span>
             <input type="url" name="site_internet" placeholder="https://www.monsite.fr"
               value="{{ request.form.get('site_internet','') }}">
        </label>
      </div>
    </fieldset>

    <div class="demande-actions">
      <button type="submit" class="publish-btn" style="width:100%; padding:14px; font-size:1rem;">
        S'inscrire
      </button>
      
      <div style="display:flex; gap:12px; margin-top:12px;">
        <a class="btn-secondary" href="{{ url_for('login') }}" 
           style="flex:1; padding:10px; border-radius:8px; background:#23232a; color:var(--text); text-decoration:none; display:block; text-align:center; border:1px solid var(--border);">
          Annuler
        </a>
      </div>

      <p class="text-muted" style="margin:16px 0 0 0; font-size:0.85rem; text-align:center;">
        Déjà un compte ? <a href="{{ url_for('login') }}" style="color:var(--primary); text-decoration:underline;">Se connecter</a>
      </p>
    </div>
  </form>
</div>

{# Hide SEO block and footer on register page #}
<style>
  main.container .seo-block { display: none; }
  .site-footer { display: none; }
</style>
{% endblock %}
